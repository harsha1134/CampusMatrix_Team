<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CampusMatrix - Forgot Password</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    :root {
      --jet-stream: #BDD9D7;
      --blue-whale: #03363D;
      --light-blue: #0ea5e9;
      --light-bg: #f8fafc;
      --card-bg: #ffffff;
      --text-light: #64748b;
      --input-border: #cbd5e1;
      --success: #10b981;
      --error: #ef4444;
    }
    
    body {
      background-color: var(--light-bg);
      color: var(--blue-whale);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    
    /* Split Screen Container */
    .split-container {
      display: flex;
      min-height: 100vh;
    }
    
    /* Left Side - Brand & Visuals */
    .left-side {
      flex: 1;
      background: linear-gradient(135deg, var(--blue-whale) 0%, #05454d 100%);
      color: var(--jet-stream);
      padding: 60px 50px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    
    .left-side::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url('https://images.unsplash.com/photo-1523050854058-8df90110c9f1?ixlib=rb-4.0.3&auto=format&fit=crop&w=1000&q=80') center/cover;
      opacity: 0.15;
    }
    
    .logo {
      font-size: 2.8rem;
      font-weight: 700;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      position: relative;
      z-index: 2;
    }
    
    .logo span {
      color: var(--jet-stream);
    }
    
    .welcome-text {
      margin-bottom: 40px;
      position: relative;
      z-index: 2;
    }
    
    .welcome-text h1 {
      font-size: 2.5rem;
      margin-bottom: 15px;
      line-height: 1.2;
    }
    
    .welcome-text p {
      font-size: 1.1rem;
      color: rgba(189, 217, 215, 0.9);
      max-width: 500px;
    }
    
    .features {
      margin-top: 40px;
      position: relative;
      z-index: 2;
    }
    
    .feature-item {
      display: flex;
      align-items: center;
      margin-bottom: 25px;
      gap: 15px;
    }
    
    .feature-icon {
      width: 50px;
      height: 50px;
      background-color: rgba(189, 217, 215, 0.15);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      color: var(--jet-stream);
    }
    
    .feature-text h4 {
      font-size: 1.2rem;
      margin-bottom: 5px;
    }
    
    .feature-text p {
      font-size: 0.95rem;
      color: rgba(189, 217, 215, 0.8);
    }
    
    /* Right Side - Form */
    .right-side {
      flex: 1.2;
      background-color: var(--card-bg);
      padding: 40px 60px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      overflow-y: auto;
    }
    
    .form-container {
      max-width: 500px;
      width: 100%;
      margin: 0 auto;
    }
    
    .form-header {
      text-align: center;
      margin-bottom: 40px;
    }
    
    .form-header h2 {
      font-size: 2rem;
      margin-bottom: 10px;
      color: var(--blue-whale);
    }
    
    .form-header p {
      color: var(--text-light);
      font-size: 1rem;
    }
    
    .form-group {
      margin-bottom: 25px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--blue-whale);
    }
    
    .input-with-icon {
      position: relative;
    }
    
    .input-with-icon i {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-light);
    }
    
    .form-control {
      width: 100%;
      padding: 15px 15px 15px 50px;
      border: 2px solid var(--input-border);
      border-radius: 10px;
      font-size: 1rem;
      transition: all 0.3s;
      background-color: white;
    }
    
    .form-control:focus {
      outline: none;
      border-color: var(--jet-stream);
      box-shadow: 0 0 0 3px rgba(189, 217, 215, 0.3);
    }
    
    /* Progress Steps */
    .progress-steps {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 40px;
      margin-bottom: 40px;
    }
    
    .step {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }
    
    .step-circle {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: var(--input-border);
      color: var(--text-light);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 16px;
      transition: all 0.3s;
    }
    
    .step-circle.active {
      background-color: var(--jet-stream);
      color: var(--blue-whale);
    }
    
    .step-circle.completed {
      background-color: var(--success);
      color: white;
    }
    
    .step-label {
      font-size: 0.9rem;
      color: var(--text-light);
      font-weight: 500;
    }
    
    .step-label.active {
      color: var(--blue-whale);
      font-weight: 600;
    }
    
    /* OTP Section */
    .otp-section {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .otp-inputs {
      display: flex;
      gap: 12px;
      justify-content: center;
      margin: 25px 0;
    }
    
    .otp-input {
      width: 55px;
      height: 55px;
      text-align: center;
      font-size: 1.5rem;
      font-weight: 600;
      border: 2px solid var(--input-border);
      border-radius: 8px;
      background-color: white;
      color: var(--blue-whale);
    }
    
    .otp-input:focus {
      outline: none;
      border-color: var(--jet-stream);
      box-shadow: 0 0 0 3px rgba(189, 217, 215, 0.3);
    }
    
    .otp-timer {
      text-align: center;
      color: var(--text-light);
      margin-top: 15px;
      font-size: 0.9rem;
    }
    
    .otp-timer span {
      color: var(--blue-whale);
      font-weight: 600;
    }
    
    /* Buttons */
    .btn {
      width: 100%;
      padding: 16px;
      border-radius: 10px;
      font-weight: 600;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s;
      border: none;
      margin-top: 10px;
    }
    
    .btn-primary {
      background-color: var(--jet-stream);
      color: var(--blue-whale);
    }
    
    .btn-primary:hover {
      background-color: #a8cfcb;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(3, 54, 61, 0.1);
    }
    
    .btn-secondary {
      background-color: transparent;
      color: var(--blue-whale);
      border: 2px solid var(--jet-stream);
    }
    
    .btn-secondary:hover {
      background-color: rgba(189, 217, 215, 0.1);
      transform: translateY(-2px);
    }
    
    .btn-small {
      padding: 10px 20px;
      font-size: 0.9rem;
      width: auto;
    }
    
    .login-link {
      text-align: center;
      margin-top: 30px;
      color: var(--text-light);
      font-size: 0.95rem;
    }
    
    .login-link a {
      color: var(--blue-whale);
      text-decoration: none;
      font-weight: 600;
      margin-left: 5px;
    }
    
    .login-link a:hover {
      text-decoration: underline;
    }
    
    /* Success Message */
    .success-message {
      text-align: center;
      padding: 40px 20px;
    }
    
    .success-icon {
      font-size: 80px;
      color: var(--success);
      margin-bottom: 20px;
    }
    
    /* Error Message */
    .error-message {
      background-color: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: var(--error);
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      display: none;
    }
    
    .error-message.show {
      display: block;
      animation: fadeIn 0.3s ease;
    }
    
    /* Back to Home */
    .back-to-home {
      position: absolute;
      top: 30px;
      left: 30px;
      z-index: 3;
    }
    
    .back-link {
      color: var(--jet-stream);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
      background-color: rgba(0, 0, 0, 0.2);
      padding: 10px 15px;
      border-radius: 8px;
      transition: background-color 0.3s;
    }
    
    .back-link:hover {
      background-color: rgba(0, 0, 0, 0.3);
      text-decoration: none;
    }
    
    /* New Password Form */
    .new-password-form {
      display: none;
    }
    
    .new-password-form.active {
      display: block;
      animation: fadeIn 0.5s ease;
    }
    
    .password-strength {
      margin-top: 10px;
      height: 6px;
      background-color: var(--input-border);
      border-radius: 3px;
      overflow: hidden;
    }
    
    .password-strength-bar {
      height: 100%;
      width: 0%;
      border-radius: 3px;
      transition: width 0.3s, background-color 0.3s;
    }
    
    .password-hint {
      font-size: 0.85rem;
      color: var(--text-light);
      margin-top: 8px;
    }
    
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* Responsive */
    @media (max-width: 992px) {
      .split-container {
        flex-direction: column;
      }
      
      .left-side, .right-side {
        padding: 40px 30px;
      }
      
      .form-container {
        max-width: 100%;
      }
      
      .back-to-home {
        top: 20px;
        left: 20px;
      }
      
      .progress-steps {
        gap: 30px;
      }
    }
    
    @media (max-width: 768px) {
      .welcome-text h1 {
        font-size: 2rem;
      }
      
      .logo {
        font-size: 2.2rem;
      }
      
      .form-header h2 {
        font-size: 1.8rem;
      }
      
      .progress-steps {
        flex-direction: column;
        gap: 20px;
      }
      
      .step {
        flex-direction: row;
        width: 100%;
        justify-content: flex-start;
        gap: 15px;
      }
      
      .otp-input {
        width: 45px;
        height: 45px;
        font-size: 1.2rem;
      }
    }
    
    @media (max-width: 480px) {
      .left-side, .right-side {
        padding: 30px 20px;
      }
      
      .logo {
        font-size: 1.8rem;
      }
      
      .welcome-text h1 {
        font-size: 1.6rem;
      }
      
      .form-header h2 {
        font-size: 1.5rem;
      }
      
      .back-to-home {
        top: 15px;
        left: 15px;
      }
      
      .back-link {
        padding: 8px 12px;
        font-size: 0.9rem;
      }
      
      .feature-item {
        flex-direction: column;
        text-align: center;
        gap: 10px;
      }
      
      .otp-inputs {
        gap: 8px;
      }
      
      .otp-input {
        width: 40px;
        height: 40px;
        font-size: 1.1rem;
      }
    }
  </style>
</head>
<body>
  <!-- Split Screen Container -->
  <div class="split-container">
    <!-- Left Side - Brand & Visuals -->
    <div class="left-side">
      <div class="back-to-home">
        <a href="index.html" class="back-link">
          <i class="fas fa-arrow-left"></i>
          Back to Home
        </a>
      </div>
      
      <div class="logo">
        <i class="fas fa-university"></i>
        <span>CampusMatrix</span>
      </div>
      
      <div class="welcome-text">
        <h1>Reset Your Password</h1>
        <p>Follow these simple steps to securely reset your CampusMatrix password and regain access to your account.</p>
      </div>
      
      <div class="features">
        <div class="feature-item">
          <div class="feature-icon">
            <i class="fas fa-shield-alt"></i>
          </div>
          <div class="feature-text">
            <h4>Secure Process</h4>
            <p>Your account security is our top priority. We use OTP verification for safety.</p>
          </div>
        </div>
        
        <div class="feature-item">
          <div class="feature-icon">
            <i class="fas fa-clock"></i>
          </div>
          <div class="feature-text">
            <h4>Quick Recovery</h4>
            <p>Reset your password in just a few minutes and get back to campus activities.</p>
          </div>
        </div>
        
        <div class="feature-item">
          <div class="feature-icon">
            <i class="fas fa-mobile-alt"></i>
          </div>
          <div class="feature-text">
            <h4>Email Verification</h4>
            <p>We'll send a verification code to your registered email address.</p>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Right Side - Forgot Password Form -->
    <div class="right-side">
      <div class="form-container">
        <!-- Step 1: Enter Email -->
        <div id="step1" class="form-step active">
          <div class="form-header">
            <h2>Reset Your Password</h2>
            <p>Enter your registered email to receive a verification code</p>
          </div>
          
          <div class="progress-steps">
            <div class="step">
              <div class="step-circle active">1</div>
              <div class="step-label active">Enter Email</div>
            </div>
            <div class="step">
              <div class="step-circle">2</div>
              <div class="step-label">Verify OTP</div>
            </div>
            <div class="step">
              <div class="step-circle">3</div>
              <div class="step-label">New Password</div>
            </div>
          </div>
          
          <div class="error-message" id="errorMessage">
            <i class="fas fa-exclamation-circle"></i> 
            <span id="errorText"></span>
          </div>
          
          <form id="emailForm">
            <div class="form-group">
              <label for="email">Email Address</label>
              <div class="input-with-icon">
                <i class="fas fa-envelope"></i>
                <input type="email" id="email" class="form-control" placeholder="student@college.edu" required>
              </div>
              <div class="password-hint">Enter the email address associated with your CampusMatrix account</div>
            </div>
            
            <button type="submit" class="btn btn-primary">Send Verification Code</button>
          </form>
          
          <div class="login-link">
            Remember your password? <a href="login.html">Back to Login</a>
          </div>
        </div>
        
        <!-- Step 2: Verify OTP -->
        <div id="step2" class="form-step" style="display: none;">
          <div class="form-header">
            <h2>Verify Your Email</h2>
            <p>Enter the 6-digit code sent to your email</p>
          </div>
          
          <div class="progress-steps">
            <div class="step">
              <div class="step-circle completed">1</div>
              <div class="step-label">Enter Email</div>
            </div>
            <div class="step">
              <div class="step-circle active">2</div>
              <div class="step-label active">Verify OTP</div>
            </div>
            <div class="step">
              <div class="step-circle">3</div>
              <div class="step-label">New Password</div>
            </div>
          </div>
          
          <div class="otp-section">
            <p>We've sent a verification code to: <strong id="userEmail"></strong></p>
            
            <div class="otp-inputs">
              <input type="text" class="otp-input" maxlength="1" data-index="0">
              <input type="text" class="otp-input" maxlength="1" data-index="1">
              <input type="text" class="otp-input" maxlength="1" data-index="2">
              <input type="text" class="otp-input" maxlength="1" data-index="3">
              <input type="text" class="otp-input" maxlength="1" data-index="4">
              <input type="text" class="otp-input" maxlength="1" data-index="5">
            </div>
            
            <div class="otp-timer">
              Code expires in: <span id="otpTimer">05:00</span>
            </div>
          </div>
          
          <button type="button" id="verifyOtpBtn" class="btn btn-primary">Verify Code</button>
          <button type="button" id="resendOtpBtn" class="btn btn-secondary" style="margin-top: 15px;">
            <i class="fas fa-redo"></i> Resend Code
          </button>
          
          <div class="login-link">
            <a href="#" id="backToEmail">Back to email entry</a>
          </div>
        </div>
        
        <!-- Step 3: New Password -->
        <div id="step3" class="form-step" style="display: none;">
          <div class="form-header">
            <h2>Create New Password</h2>
            <p>Create a strong new password for your account</p>
          </div>
          
          <div class="progress-steps">
            <div class="step">
              <div class="step-circle completed">1</div>
              <div class="step-label">Enter Email</div>
            </div>
            <div class="step">
              <div class="step-circle completed">2</div>
              <div class="step-label">Verify OTP</div>
            </div>
            <div class="step">
              <div class="step-circle active">3</div>
              <div class="step-label active">New Password</div>
            </div>
          </div>
          
          <form id="newPasswordForm">
            <div class="form-group">
              <label for="newPassword">New Password</label>
              <div class="input-with-icon">
                <i class="fas fa-lock"></i>
                <input type="password" id="newPassword" class="form-control" placeholder="Create a strong password" required minlength="8">
              </div>
              <div class="password-strength">
                <div class="password-strength-bar" id="passwordStrengthBar"></div>
              </div>
              <div class="password-hint">Use at least 8 characters with letters, numbers, and symbols</div>
            </div>
            
            <div class="form-group">
              <label for="confirmPassword">Confirm Password</label>
              <div class="input-with-icon">
                <i class="fas fa-lock"></i>
                <input type="password" id="confirmPassword" class="form-control" placeholder="Re-enter your password" required>
              </div>
            </div>
            
            <button type="submit" class="btn btn-primary">Reset Password</button>
          </form>
          
          <div class="login-link">
            <a href="#" id="backToOtp">Back to OTP verification</a>
          </div>
        </div>
        
        <!-- Success Message -->
        <div id="successStep" class="form-step" style="display: none;">
          <div class="success-message">
            <div class="success-icon">
              <i class="fas fa-check-circle"></i>
            </div>
            <h2 style="color: var(--blue-whale); margin-bottom: 15px;">Password Reset Successful!</h2>
            <p style="color: var(--text-light); margin-bottom: 30px;">Your password has been successfully reset. You can now log in with your new password.</p>
            <a href="login.html" class="btn btn-primary">Go to Login</a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // DOM Elements
    const emailForm = document.getElementById('emailForm');
    const newPasswordForm = document.getElementById('newPasswordForm');
    const verifyOtpBtn = document.getElementById('verifyOtpBtn');
    const resendOtpBtn = document.getElementById('resendOtpBtn');
    const backToEmail = document.getElementById('backToEmail');
    const backToOtp = document.getElementById('backToOtp');
    const otpInputs = document.querySelectorAll('.otp-input');
    const otpTimer = document.getElementById('otpTimer');
    const userEmail = document.getElementById('userEmail');
    const errorMessage = document.getElementById('errorMessage');
    const errorText = document.getElementById('errorText');
    const newPasswordInput = document.getElementById('newPassword');
    const strengthBar = document.getElementById('passwordStrengthBar');
    
    // Variables
    let currentStep = 1;
    let otpTimeLeft = 300; // 5 minutes in seconds
    let otpTimerInterval;
    let generatedOTP = '';
    let userEmailAddress = '';
    
    // Step Navigation Functions
    function showStep(stepNumber) {
      // Hide all steps
      document.querySelectorAll('.form-step').forEach(step => {
        step.style.display = 'none';
      });
      
      // Show selected step
      document.getElementById(`step${stepNumber}`).style.display = 'block';
      currentStep = stepNumber;
    }
    
    function showSuccess() {
      document.querySelectorAll('.form-step').forEach(step => {
        step.style.display = 'none';
      });
      document.getElementById('successStep').style.display = 'block';
    }
    
    // Show error message
    function showError(message) {
      errorText.textContent = message;
      errorMessage.classList.add('show');
      setTimeout(() => {
        errorMessage.classList.remove('show');
      }, 5000);
    }
    
    // Password strength indicator
    newPasswordInput.addEventListener('input', function() {
      const password = this.value;
      let strength = 0;
      
      // Length check
      if (password.length >= 8) strength += 25;
      if (password.length >= 12) strength += 10;
      
      // Complexity checks
      if (/[A-Z]/.test(password)) strength += 25;
      if (/[0-9]/.test(password)) strength += 25;
      if (/[^A-Za-z0-9]/.test(password)) strength += 25;
      
      // Cap at 100
      strength = Math.min(strength, 100);
      
      // Update bar
      strengthBar.style.width = strength + '%';
      
      // Update color based on strength
      if (strength < 50) {
        strengthBar.style.backgroundColor = '#ef4444'; // Red
      } else if (strength < 75) {
        strengthBar.style.backgroundColor = '#f59e0b'; // Orange
      } else {
        strengthBar.style.backgroundColor = '#10b981'; // Green
      }
    });
    
    // OTP input navigation
    otpInputs.forEach((input, index) => {
      input.addEventListener('input', (e) => {
        // Only allow numbers
        e.target.value = e.target.value.replace(/\D/g, '');
        
        // Move to next input
        if (e.target.value.length === 1 && index < otpInputs.length - 1) {
          otpInputs[index + 1].focus();
        }
      });
      
      input.addEventListener('keydown', (e) => {
        // Handle backspace
        if (e.key === 'Backspace' && !input.value && index > 0) {
          otpInputs[index - 1].focus();
        }
      });
    });
    
    // Generate OTP
    function generateOTP() {
      return Math.floor(100000 + Math.random() * 900000).toString();
    }
    
    // Start OTP timer
    function startOtpTimer() {
      clearInterval(otpTimerInterval);
      otpTimeLeft = 300;
      updateOtpTimer();
      
      otpTimerInterval = setInterval(() => {
        otpTimeLeft--;
        updateOtpTimer();
        
        if (otpTimeLeft <= 0) {
          clearInterval(otpTimerInterval);
          otpTimer.textContent = "00:00";
          verifyOtpBtn.disabled = true;
        }
      }, 1000);
    }
    
    function updateOtpTimer() {
      const minutes = Math.floor(otpTimeLeft / 60);
      const seconds = otpTimeLeft % 60;
      otpTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
    }
    
    // Step 1: Email submission
    emailForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const email = document.getElementById('email').value.trim();
      
      if (!email.includes('@') || !email.includes('.')) {
        showError('Please enter a valid email address.');
        return;
      }
      
      // Check if email exists in localStorage (demo)
      const allUsers = JSON.parse(localStorage.getItem('campusMatrixUsers') || '{}');
      let userExists = false;
      
      for (const key in allUsers) {
        if (allUsers[key].collegeEmail === email || allUsers[key].personalEmail === email) {
          userExists = true;
          break;
        }
      }
      
      // For demo purposes, accept any email
      userExists = true;
      
      if (!userExists) {
        showError('No account found with this email address.');
        return;
      }
      
      // Store email
      userEmailAddress = email;
      userEmail.textContent = email;
      
      // Generate OTP
      generatedOTP = generateOTP();
      console.log(`OTP for ${email}: ${generatedOTP}`); // For demo only
      alert(`For demo: OTP sent to ${email} is: ${generatedOTP}`);
      
      // Move to step 2
      showStep(2);
      startOtpTimer();
      verifyOtpBtn.disabled = false;
      otpInputs[0].focus();
    });
    
    // Step 2: OTP verification
    verifyOtpBtn.addEventListener('click', function() {
      let enteredOTP = '';
      otpInputs.forEach(input => {
        enteredOTP += input.value;
      });
      
      if (enteredOTP.length !== 6) {
        showError('Please enter the complete 6-digit code.');
        return;
      }
      
      // Check if OTP is expired
      if (otpTimeLeft <= 0) {
        showError('OTP has expired. Please request a new one.');
        return;
      }
      
      // Verify OTP (demo: accept any 6-digit number, but show correct one)
      if (enteredOTP === generatedOTP) {
        // Move to step 3
        showStep(3);
        newPasswordInput.focus();
      } else {
        showError(`Invalid OTP. For demo, use: ${generatedOTP}`);
      }
    });
    
    // Resend OTP
    resendOtpBtn.addEventListener('click', function() {
      if (otpTimeLeft > 240) { // Can only resend after 1 minute
        showError('Please wait before requesting a new code.');
        return;
      }
      
      // Generate new OTP
      generatedOTP = generateOTP();
      console.log(`New OTP for ${userEmailAddress}: ${generatedOTP}`); // For demo only
      alert(`New OTP sent to ${userEmailAddress} is: ${generatedOTP}`);
      
      // Clear inputs
      otpInputs.forEach(input => {
        input.value = '';
      });
      
      // Reset timer
      startOtpTimer();
      verifyOtpBtn.disabled = false;
      otpInputs[0].focus();
    });
    
    // Step 3: New password submission
    newPasswordForm.addEventListener('submit', function(e) {
      e.preventDefault();
      
      const newPassword = document.getElementById('newPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      
      // Check if passwords match
      if (newPassword !== confirmPassword) {
        showError('Passwords do not match. Please try again.');
        return;
      }
      
      // Check password strength
      if (newPassword.length < 8) {
        showError('Password must be at least 8 characters long.');
        return;
      }
      
      // Update password in localStorage (demo)
      const allUsers = JSON.parse(localStorage.getItem('campusMatrixUsers') || '{}');
      let updated = false;
      
      for (const key in allUsers) {
        if (allUsers[key].collegeEmail === userEmailAddress || allUsers[key].personalEmail === userEmailAddress) {
          allUsers[key].password = newPassword;
          localStorage.setItem('campusMatrixUsers', JSON.stringify(allUsers));
          updated = true;
          break;
        }
      }
      
      if (!updated) {
        // For demo, create a temp record
        console.log(`Demo: Password for ${userEmailAddress} would be updated to: ${newPassword}`);
      }
      
      // Show success
      showSuccess();
    });
    
    // Back navigation
    backToEmail.addEventListener('click', function(e) {
      e.preventDefault();
      showStep(1);
    });
    
    backToOtp.addEventListener('click', function(e) {
      e.preventDefault();
      showStep(2);
    });
    
    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      // Focus email input
      document.getElementById('email').focus();
    });
  </script>
</body>
</html>